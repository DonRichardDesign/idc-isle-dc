version: "3.7"
services:
  drupal:
    depends_on:
    - snapshot
  mariadb:
    volumes:
    - mariadb-dump:/mariadb-dump
    depends_on:
    - snapshot
  solr:
    depends_on:
    - snapshot
  snapshot:
    container_name: snapshot
    image: ${REPOSITORY}/snapshot:${SNAPSHOT_TAG}
    volumes:
    - drupal-sites-data:/data/drupal
    - mariadb-data:/data/mariadb-data
    - mariadb-files:/data/mariadb-files
    - mariadb-dump:/data/mariadb-dump
    - solr-data:/data/solr
volumes:
  mariadb-dump: